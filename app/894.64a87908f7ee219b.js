"use strict";(self.webpackChunkquote_cli_01=self.webpackChunkquote_cli_01||[]).push([[894],{8894:(S,m,r)=>{r.r(m),r.d(m,{QuoteDetailModule:()=>F});var u=r(6895),l=r(2510),t=r(4650),v=r(8779),p=r(7009),_=r(2621),g=r(8139),h=r(4726),d=r(7392),c=r(1561),Z=r(2327),T=r(2419),f=r(2993);function Q(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",15)(1,"mat-icon",16),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.onEditHeader())}),t._uU(2,"edit"),t.qZA()()}}function b(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"span")(1,"mat-icon",34),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,s=t.oxw();return t.KtG(s.onEditItem(n))}),t._uU(2,"edit"),t.qZA(),t.TgZ(3,"mat-icon",16),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,s=t.oxw();return t.KtG(s.onDelItem(n))}),t._uU(4,"delete"),t.qZA()()}}function A(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"span")(1,"mat-icon",34),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,s=t.oxw();return t.KtG(s.onEditItem(n))}),t._uU(2,"edit"),t.qZA(),t.TgZ(3,"mat-icon",16),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,s=t.oxw();return t.KtG(s.onDelItem(n))}),t._uU(4,"delete"),t.qZA()()}}function U(o,a){if(1&o&&(t.TgZ(0,"div")(1,"div",17),t._uU(2),t.qZA(),t.TgZ(3,"div",18)(4,"div",19),t._UZ(5,"img",20),t.qZA(),t.TgZ(6,"div",21)(7,"div",22),t._uU(8,"Descripci\xf3n"),t.qZA(),t.TgZ(9,"ul",23)(10,"li")(11,"span",14),t._uU(12,"MATERIAL: "),t.qZA(),t._uU(13),t.qZA(),t._UZ(14,"div",24),t.TgZ(15,"li")(16,"span",14),t._uU(17,"MEDIDAS: "),t.qZA(),t._uU(18),t.qZA(),t._UZ(19,"div",24),t.TgZ(20,"li")(21,"span",14),t._uU(22,"\xc1REA DE IMPRESI\xd3N APROXIMADA: "),t.qZA(),t._uU(23),t.qZA(),t._UZ(24,"div",24),t.TgZ(25,"li")(26,"span",14),t._uU(27,"MARCA: "),t.qZA(),t._uU(28),t.qZA(),t._UZ(29,"div",24),t.TgZ(30,"li")(31,"span",14),t._uU(32,"EMPAQUE: "),t.qZA(),t._uU(33),t.qZA(),t._UZ(34,"div",24),t.qZA()()(),t.TgZ(35,"div",18)(36,"div",25)(37,"div",22),t._uU(38," Observaci\xf3n "),t.YNc(39,b,5,0,"span",26),t.qZA(),t.TgZ(40,"div",27),t._uU(41),t.qZA()(),t.TgZ(42,"div",28)(43,"div",22),t._uU(44," Informaci\xf3n cotizada "),t.YNc(45,A,5,0,"span",26),t.qZA(),t.TgZ(46,"div",29)(47,"div",30),t._uU(48,"Referencia"),t.qZA(),t.TgZ(49,"div",31),t._uU(50),t.qZA(),t.TgZ(51,"div",30),t._uU(52,"Color"),t.qZA(),t.TgZ(53,"div",31),t._uU(54),t.qZA(),t.TgZ(55,"div",30),t._uU(56,"Opci\xf3n"),t.qZA(),t._UZ(57,"div",30)(58,"div",32)(59,"div",32),t.TgZ(60,"div",30),t._uU(61,"Cantidad"),t.qZA(),t.TgZ(62,"div",33),t._uU(63),t.ALo(64,"number"),t.qZA(),t.TgZ(65,"div",30),t._uU(66,"Precio unitario"),t.qZA(),t.TgZ(67,"div",33),t._uU(68),t.ALo(69,"currency"),t.qZA(),t.TgZ(70,"div",30),t._uU(71,"Sub-total antes IVA"),t.qZA(),t.TgZ(72,"div",33),t._uU(73),t.ALo(74,"currency"),t.qZA(),t.TgZ(75,"div",30),t._uU(76,"TOTAL con IVA"),t.qZA(),t.TgZ(77,"div",33),t._uU(78),t.ALo(79,"currency"),t.qZA()()()()()),2&o){const e=a.$implicit,i=t.oxw();t.xp6(2),t.AsE("",e.familia," - ",e.descripcion_comercial," "),t.xp6(3),t.Q6J("src",i.getImage(e),t.LSH),t.xp6(8),t.Oqu(e.material),t.xp6(5),t.Oqu(e.medidas_diametro),t.xp6(5),t.Oqu(e.area_impresion),t.xp6(5),t.Oqu(e.tecnica_marca_descripcion),t.xp6(5),t.gL8(" ",e.empaque_unds_caja," Unidades en caja de ",e.empaque_ancho," cm, ",e.empaque_alto," cm, ",e.empaque_largo," cm - Peso bruto: ",e.empaque_peso_bruto," Kg - Peso neto: ",e.empaque_peso_neto," Kg "),t.xp6(6),t.Q6J("ngIf",i.edit),t.xp6(2),t.hij(" ",e.itemTag.notas," "),t.xp6(4),t.Q6J("ngIf",i.edit),t.xp6(5),t.Oqu(e.familia),t.xp6(4),t.Oqu(e.materiales[0].color_nombre),t.xp6(9),t.Oqu(t.lcZ(64,22,e.itemTag.cantidad)),t.xp6(5),t.Oqu(t.lcZ(69,24,e.itemTag.precio)),t.xp6(5),t.Oqu(t.lcZ(74,26,i.getSubTtlXItem(e))),t.xp6(5),t.Oqu(t.lcZ(79,28,i.getTtlXItem(e)))}}function C(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",15)(1,"mat-icon",16),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.onEditCondition())}),t._uU(2,"edit"),t.qZA()()}}function q(o,a){if(1&o&&(t.TgZ(0,"div"),t._UZ(1,"app-cond-quote",35),t.qZA()),2&o){const e=a.$implicit;t.xp6(1),t.Q6J("condition",e)("edit",!1)}}function x(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",15)(1,"mat-icon",16),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.onEditFooter())}),t._uU(2,"edit"),t.qZA()()}}let y=(()=>{class o{constructor(e,i,n,s){this.mngodb=e,this.dg=i,this.nvg=n,this.sharedvar=s,this.edit=!1,this.onChange=new t.vpe,this.ttlBruto=0,this.ttlIva=0,this.total=0,this.quote_cond_list=[]}ngOnInit(){this.sharedvar.selQuote.status<2&&this.dg.updatePropResult(this.sharedvar.selQuote,this.sharedvar.defaWishData),this.sharedvar.general.quote_condition.length>0&&(this.quote_cond_list=JSON.parse(this.sharedvar.general.quote_condition)),this.onQitemChange()}getImage(e){return e.materiales[0].imagenes[0].imagen.file_sm}getSubTtlXItem(e){return e.itemTag.cantidad*e.itemTag.precio}getTtlXItem(e){return e.itemTag.cantidad*e.itemTag.precio+e.itemTag.cantidad*e.itemTag.precio*e.itemTag.p_iva/100}onEditHeader(){this.dg.aDefault({title:"Editar encabezado",value:this.sharedvar.selQuote,schema:{controls:[{name:"strdate",label:"Fecha:",type:"date",validators:{required:!0}},{name:"consecutive",label:"Consecutivo:",type:"text",style:"w-full",validators:{required:!0}},{name:"client_name",label:"Nombre de la empresa:",type:"text",style:"w-full",validators:{required:!0}},{name:"client_contact",label:"Dirigido a:",type:"text",style:"w-full",validators:{}}]}}).subscribe(n=>{n&&(this.sharedvar.selQuote.date=new Date(n.strdate).getTime(),this.dg.updatePropResult(this.sharedvar.selQuote,n),this.onChange.emit(this.sharedvar.selQuote))})}onEditItem(e){this.dg.aQuoteEdit({title:"Editar item",dgheigth:475,value:e}).subscribe(n=>{n&&(this.dg.updatePropResult(e,n),this.onQitemChange(),this.onChange.emit(this.sharedvar.selQuote))})}onEditFooter(){this.dg.aDefault({title:"Editar agente",value:this.sharedvar.defaWishData,schema:{controls:[{name:"agent_name",label:"Nombre del agente:",type:"text",style:"w-full",validators:{required:!0}},{name:"agent_phone",label:"Tel\xe9fono:",type:"text",style:"w-full",validators:{}},{name:"agent_email",label:"Email:",type:"text",validators:{}},{name:"agent_city",label:"Ciudad:",type:"text",validators:{}}]}}).subscribe(n=>{n&&(this.dg.updatePropResult(this.sharedvar.defaWishData,n),this.mngodb.updateDefaData(),this.sharedvar.selQuote.date=new Date(n.strdate).getTime(),this.dg.updatePropResult(this.sharedvar.selQuote,n),this.onChange.emit(this.sharedvar.selQuote))})}onDelItem(e){this.onQitemChange()}onQitemChange(){this.ttlBruto=0,this.total=0,this.ttlIva=0,this.sharedvar.selQuote.itemList.forEach(e=>{this.ttlBruto=e.itemTag.cantidad*e.itemTag.precio-e.itemTag.descuento,this.ttlIva+=e.itemTag.p_iva*this.ttlBruto/100,this.total+=this.ttlBruto+this.ttlIva})}onEditCondition(){this.nvg.onRouteDetail("Editar: condiciones Comerciales","","quotedoc",!0)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(_.r),t.Y36(Z.x),t.Y36(T.$),t.Y36(g.m))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-qoute-preview"]],inputs:{edit:"edit"},outputs:{onChange:"onChange"},decls:59,vars:25,consts:[[1,"m-4","flex","h-full","w-full","flex-col","items-start"],[1,"w-11/12","text-sm"],[1,"mt-3","h-20","border-b","border-gray-300"],["src","http://omvpublicidad.com/wp-content/themes/omv/core/images/default-logo.png","alt","omvpublicidad",1,"h-16","object-contain"],["class","p-1 h-12 bg-slate-100 w-full",4,"ngIf"],[1,"my-3","text-right"],[1,"mt-4"],[4,"ngFor","ngForOf"],[1,"mt-2","text-lg"],[1,"grid","w-60","grid-cols-2"],[1,"text-right"],[1,"mt-2"],[1,"border","border-gray-200","bg-slate-100","p-1","text-center","font-medium"],[1,"mt-10"],[1,"font-medium"],[1,"p-1","h-12","bg-slate-100","w-full"],["color","warn",3,"click"],[1,"mt-4","border","border-gray-200","bg-gray-50","p-1","text-base","font-medium","text-gray-700"],[1,"flex","flex-row"],[1,"mr-1","mt-2","w-1/2","border","border-gray-200"],["alt","qitem.descripcion_comercial",1,"object-contain",3,"src"],[1,"ml-1","mt-2","h-72","w-1/2","border","border-gray-200"],[1,"h-7","border-b","border-gray-200","bg-gray-50","p-1","font-medium","text-gray-700"],[1,"px-6","list-disc","text-xs"],[1,"h-1"],[1,"mt-2","h-72","w-1/2","border","border-gray-200"],[4,"ngIf"],[1,"p-1"],[1,"ml-2","mt-2","h-72","w-1/2","border","border-gray-200"],[1,"m-2","grid","grid-cols-2"],[1,"border","border-gray-200","bg-slate-100","p-1"],[1,"border","border-gray-200","bg-slate-100","p-1","text-center"],[1,"h-5"],[1,"border","border-gray-200","bg-slate-100","p-1","text-right"],["color","primary",3,"click"],[3,"condition","edit"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._UZ(3,"img",3),t.qZA(),t.YNc(4,Q,3,0,"div",4),t.TgZ(5,"div",5),t._uU(6),t.ALo(7,"date"),t._UZ(8,"br"),t._uU(9),t.qZA(),t.TgZ(10,"div"),t._uU(11,"Se\xf1ores: "),t._UZ(12,"br"),t._uU(13),t._UZ(14,"br"),t._uU(15),t.qZA(),t.TgZ(16,"div",6),t._uU(17,"Respetado se\xf1or(a):"),t._UZ(18,"br"),t._uU(19,"De acuerdo a su amable solicitud me permito presentarle la siguiente cotizaci\xf3n:"),t.qZA(),t._UZ(20,"br"),t.YNc(21,U,80,30,"div",7),t.TgZ(22,"div",8)(23,"div",9)(24,"div"),t._uU(25,"SUBTOTAL:"),t.qZA(),t.TgZ(26,"div",10),t._uU(27),t.ALo(28,"currency"),t.qZA(),t.TgZ(29,"div"),t._uU(30,"IVA:"),t.qZA(),t.TgZ(31,"div",10),t._uU(32),t.ALo(33,"currency"),t.qZA(),t.TgZ(34,"div"),t._uU(35,"TOTAL:"),t.qZA(),t.TgZ(36,"div",10),t._uU(37),t.ALo(38,"currency"),t.qZA()()(),t.TgZ(39,"div",11)(40,"div",12),t._uU(41," CONDICIONES COMERCIALES "),t.YNc(42,C,3,0,"div",4),t.qZA(),t.YNc(43,q,2,2,"div",7),t.qZA(),t.TgZ(44,"div",13),t._uU(45," Atentamente,"),t._UZ(46,"br"),t.YNc(47,x,3,0,"div",4),t.TgZ(48,"div",14),t._uU(49),t.qZA(),t._uU(50),t._UZ(51,"br"),t._uU(52),t._UZ(53,"br"),t._uU(54," Direccion: omv direccion "),t._UZ(55,"br"),t._uU(56," Bogot\xe1, Colombia "),t._UZ(57,"br"),t._uU(58," www.omv.com "),t.qZA()()()),2&e&&(t.xp6(4),t.Q6J("ngIf",i.edit),t.xp6(2),t.AsE("",i.sharedvar.selQuote.agent_city,", \xa0 ",t.xi3(7,16,i.sharedvar.selQuote.date,"dd/MM/yyyy"),""),t.xp6(3),t.hij("Cotizacion No ",i.sharedvar.selQuote.consecutive,""),t.xp6(4),t.hij("",i.sharedvar.selQuote.client_name," "),t.xp6(2),t.Oqu(i.sharedvar.selQuote.client_contact),t.xp6(6),t.Q6J("ngForOf",i.sharedvar.selQuote.itemList),t.xp6(6),t.Oqu(t.lcZ(28,19,i.ttlBruto)),t.xp6(5),t.Oqu(t.lcZ(33,21,i.ttlIva)),t.xp6(5),t.Oqu(t.lcZ(38,23,i.total)),t.xp6(5),t.Q6J("ngIf",i.edit),t.xp6(1),t.Q6J("ngForOf",i.quote_cond_list),t.xp6(4),t.Q6J("ngIf",i.edit),t.xp6(2),t.Oqu(i.sharedvar.selQuote.agent_name),t.xp6(1),t.hij(" Telefono: ",i.sharedvar.selQuote.agent_phone," "),t.xp6(2),t.hij(" Email: ",i.sharedvar.selQuote.agent_email," "))},dependencies:[u.sg,u.O5,d.Hw,f.y,u.JJ,u.H9,u.uU]}),o})();const w=["editControlTrigger"],D=[{path:"",component:(()=>{class o{constructor(e,i,n,s){this.httpq=e,this.snkBar=i,this.mngdb=n,this.sharedvar=s,this.total=0,this.ttlIva=0,this.doccss="",this.edit=!1}ngOnInit(){this.httpq.getCssData().subscribe(e=>{this.doccss=e})}getClicked(e){if(4===e.index){let i=document.getElementById("spanTrigger");i&&(i.style.display="",i.style.position="absolute",i.style.left=e.pageX+5+"px",i.style.top=e.pageY+5+"px",this.editControlTrigger.openMenu())}}onQitemChange(e){this.total=0,this.ttlIva=0,this.sharedvar.selQuote.itemList.forEach(i=>{const n=i.itemTag.cantidad*i.itemTag.precio-i.itemTag.descuento;this.ttlIva+=i.itemTag.p_iva*n/100,this.total+=n+this.ttlIva})}onCotizaWishChange(e){this.setQuote(2)}setDelete(){this.editable()&&this.snkBar.open(`Eliminar: "${this.sharedvar.selQuote.client_name} de la Lista?"`,"Eliminar",{duration:3e3}).onAction().subscribe(e=>{this.setQuote(-1)})}setSend(){if(this.editable())return this.snkBar.open("\xbfEnviar respuesta al cliente?","Si",{duration:3e3}).onAction().subscribe(e=>{this.sharedvar.selQuote.htmlQuote=this.getSnapshot(),this.setQuote(4)})}setQuote(e){2===e&&(this.sharedvar.selQuote.agent_id=this.sharedvar.user._id,this.sharedvar.selQuote.agent_name=this.sharedvar.user.name),this.editable()&&(this.sharedvar.selQuote.status=e,this.sharedvar.selQuote._id&&this.httpq.updateQuote(this.sharedvar.selQuote._id,this.sharedvar.selQuote).subscribe({error:i=>console.log(i),complete:()=>{this.snkBar.open("Datos actualizados","Ok",{duration:3e3})}}))}onEditState(e){this.edit=e}getSnapshot(){let e=document.getElementById("printsection");if(e){let i=`<!DOCTYPE html><html><head><style>\n      ${this.doccss}\n      </style></head></style></head><body>\n      ${e.outerHTML}\n      </body></html>`;return console.log(i),i}return""}editable(){return this.sharedvar.selQuote.agent_id==this.sharedvar.user._id&&this.sharedvar.selQuote.status<4}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(v.v),t.Y36(p.ux),t.Y36(_.r),t.Y36(g.m))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-quote-detail"]],viewQuery:function(e,i){if(1&e&&t.Gf(w,5),2&e){let n;t.iGM(n=t.CRH())&&(i.editControlTrigger=n.first)}},decls:33,vars:3,consts:[[1,"flex","flex-col","h-full"],[3,"buttons","onClicked"],["id","spanTrigger",3,"matMenuTriggerFor"],["editControlTrigger","matMenuTrigger"],[1,"flex-1","px-2","overflow-auto"],["id","printsection"],[3,"edit","onChange"],["controlEdit","matMenu"],["mat-menu-item","",3,"click"],["color","primary"],["color","warn"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0)(1,"app-nav-bar",1),t.NdJ("onClicked",function(s){return i.getClicked(s)}),t.qZA(),t._UZ(2,"span",2,3),t.TgZ(4,"div",4)(5,"div",5)(6,"app-qoute-preview",6),t.NdJ("onChange",function(s){return i.onCotizaWishChange(s)}),t.qZA()()(),t.TgZ(7,"mat-menu",null,7)(9,"button",8),t.NdJ("click",function(){return i.setQuote(2)}),t._uU(10," Tomarla "),t.TgZ(11,"mat-icon",9),t._uU(12,"done"),t.qZA()(),t.TgZ(13,"button",8),t.NdJ("click",function(){return i.setQuote(1)}),t._uU(14," Liberarla "),t.TgZ(15,"mat-icon",9),t._uU(16,"close"),t.qZA()(),t.TgZ(17,"button",8),t.NdJ("click",function(){return i.onEditState(!0)}),t._uU(18," Editar "),t.TgZ(19,"mat-icon",9),t._uU(20,"edit"),t.qZA()(),t.TgZ(21,"button",8),t.NdJ("click",function(){return i.onEditState(!1)}),t._uU(22," Vista previa "),t.TgZ(23,"mat-icon",9),t._uU(24,"preview"),t.qZA()(),t.TgZ(25,"button",8),t.NdJ("click",function(){return i.setSend()}),t._uU(26," Enviar "),t.TgZ(27,"mat-icon",9),t._uU(28,"send"),t.qZA()(),t.TgZ(29,"button",8),t.NdJ("click",function(){return i.setDelete()}),t.TgZ(30,"mat-icon",10),t._uU(31,"close"),t.qZA(),t._uU(32," Inhabilitar cotizaci\xf3n "),t.qZA()()()),2&e){const n=t.MAs(8);t.xp6(1),t.Q6J("buttons","000001"),t.xp6(1),t.Q6J("matMenuTriggerFor",n),t.xp6(4),t.Q6J("edit",i.edit)}},dependencies:[h.w,d.Hw,c.VK,c.OP,c.p6,y]}),o})()}];let E=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[l.Bz.forChild(D),l.Bz]}),o})();var I=r(2469),P=r(4859),M=r(3159);const J=[];let O=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[l.Bz.forChild(J),l.Bz]}),o})();var k=r(2355);let N=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[u.ez,O,d.Ps,k.z]}),o})(),F=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[u.ez,E,I.R,M.x,d.Ps,P.ot,p.ZX,c.Tx,N]}),o})()}}]);