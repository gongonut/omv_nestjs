"use strict";(self.webpackChunkquote_cli_01=self.webpackChunkquote_cli_01||[]).push([[859],{6859:(k,c,o)=>{o.r(c),o.d(c,{UsersModule:()=>Z});var d=o(6895),m=o(2510),e=o(4650),f=o(2327),v=o(9340),p=o(7009),U=o(4726),g=o(7392),u=o(1561);const C=["editControlTrigger"];function b(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"div",8)(2,"div",9),e._uU(3),e.qZA(),e.TgZ(4,"div",10),e._uU(5),e.qZA(),e.TgZ(6,"span",11)(7,"mat-icon",12),e.NdJ("click",function(){const n=e.CHM(t).$implicit,a=e.oxw();return e.KtG(a.editUser(n))}),e._uU(8,"edit"),e.qZA(),e.TgZ(9,"mat-icon",12),e.NdJ("click",function(){const n=e.CHM(t).$implicit,a=e.oxw();return e.KtG(a.onDelete(n))}),e._uU(10,"delete"),e.qZA()()()()}if(2&i){const t=l.$implicit;e.xp6(3),e.hij(" ",t.name," "),e.xp6(2),e.hij(" ",t.email," ")}}const x=[{path:"",component:(()=>{class i{constructor(t,s,r){this.dg=t,this.user=s,this.snkBar=r,this.userData={controls:[{name:"email",label:"Correo electr\xf3nico:",type:"text",style:{width:"150px"},validators:{required:!0}},{name:"password",label:"Contrase\xf1a:",type:"password",sideBtn:"visibility",validators:{required:!0}},{name:"name",label:"Nombre:",type:"text",style:{width:"150px"},validators:{required:!0}},{name:"phone",label:"Tel\xe9fono:",type:"text",style:{width:"150px"},validators:{required:!0}},{name:"city",label:"Ciudad:",type:"text",style:{width:"150px"},validators:{required:!0}},{name:"rol",label:"Permiso para editar:",type:"multiselect",validators:{required:!0},selectOptions:[{key:"Q",value:"Cotizaciones"},{key:"P",value:"Productos"},{key:"S",value:"Configuraci\xf3n"},{key:"U",value:"Usuarios"}]}]},this.usersList=[]}ngOnInit(){this.getList()}getList(){this.user.getUsersList().subscribe(t=>{this.usersList=t,this.orderList()})}orderList(){this.usersList.sort((t,s)=>t.name.localeCompare(s.name))}getClicked(t){switch(t.index){case 2:this.createUser();break;case 4:let s=document.getElementById("spanTrigger");s&&(s.style.display="",s.style.position="absolute",s.style.left=t.pageX+5+"px",s.style.top=t.pageY+5+"px",this.editControlTrigger.openMenu())}}createUser(){const t=this.user.newUser();this.dg.aDefault({title:"Crear Usuario",value:t,schema:this.userData,dgheigth:615,dgwidth:300}).subscribe(r=>{if(r&&t){this.dg.updatePropResult(t,r);const n=this.user.createUser(t).subscribe(a=>{n&&n.unsubscribe(),a&&(this.usersList.push(a),this.orderList())})}})}editUser(t){const s={...this.userData};s.controls=s.controls?.slice(2),this.dg.aDefault({title:"Editar Usuario",value:t,schema:s,dgheigth:460,dgwidth:300}).subscribe(n=>{if(n){this.dg.updatePropResult(t,n);const a=this.user.updateUser(t).subscribe(h=>{a&&a.unsubscribe()})}})}onDelete(t){return this.snkBar.open(`\xbfEliminar usuario: ${t.name}?`,"Si",{duration:3e3}).onAction().subscribe(s=>{t._id&&this.user.deleteUser(t._id).subscribe(n=>{const a=this.usersList.findIndex(h=>h._id===t._id);a>=0&&this.usersList.splice(a,1)})})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(f.x),e.Y36(v.z),e.Y36(p.ux))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-users"]],viewQuery:function(t,s){if(1&t&&e.Gf(C,5),2&t){let r;e.iGM(r=e.CRH())&&(s.editControlTrigger=r.first)}},decls:10,vars:3,consts:[[1,"flex","flex-col","h-screen","bg-slate-100"],[3,"buttons","onClicked"],["id","spanTrigger",3,"matMenuTriggerFor"],["editControlTrigger","matMenuTrigger"],[1,"overflow-auto","bg-white"],[4,"ngFor","ngForOf"],["controlEdit","matMenu"],["mat-menu-item",""],[1,"h-10","px-2","flex","items-center","bg-gray-50","mt-1"],[1,"w-52","font-medium"],[1,"ml-3","flex-1","text-sky-700"],[1,"text-sky-700"],[3,"click"]],template:function(t,s){if(1&t&&(e.TgZ(0,"div",0)(1,"app-nav-bar",1),e.NdJ("onClicked",function(n){return s.getClicked(n)}),e.qZA(),e._UZ(2,"span",2,3),e.TgZ(4,"div",4),e.YNc(5,b,11,2,"div",5),e.qZA(),e.TgZ(6,"mat-menu",null,6)(8,"button",7),e._uU(9," Crear Usuario Maestro "),e.qZA()()()),2&t){const r=e.MAs(7);e.xp6(1),e.Q6J("buttons","101000"),e.xp6(1),e.Q6J("matMenuTriggerFor",r),e.xp6(3),e.Q6J("ngForOf",s.usersList)}},dependencies:[d.sg,U.w,g.Hw,u.VK,u.OP,u.p6]}),i})()}];let y=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[m.Bz.forChild(x),m.Bz]}),i})();var T=o(2469),M=o(4859);let Z=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[d.ez,y,T.R,g.Ps,M.ot,p.ZX,u.Tx]}),i})()}}]);