"use strict";(self.webpackChunkquote_cli_01=self.webpackChunkquote_cli_01||[]).push([[435],{9435:(A,c,o)=>{o.r(c),o.d(c,{UsersModule:()=>w});var m=o(6895),g=o(2510),e=o(4650),U=o(2327),p=o(529),b=o(2621);let f=(()=>{class s{constructor(t,r){this.httpq=t,this.mongodb=r}getHeader(){return{headers:new p.WM({"Access-Control-Allow-Origin":"http://localhost:4311/","Access-Control-Allow-Headers":"Content-Type","Access-Control-Allow-Methods":"GET,PUT,POST,DELETE"})}}newUser(){return{name:"Nombre",email:"email@usuario.com",password:"",rol:[]}}getUsersList(){return this.httpq.get(`${this.mongodb.OMV_SERVER}users`)}getUsers(t){return this.httpq.get(`${this.mongodb.OMV_SERVER}users/findOne/${t}`,this.getHeader())}createUsers(t){return this.httpq.post(`${this.mongodb.OMV_SERVER}users/register`,t)}deleteUsers(t){return this.httpq.delete(`${this.mongodb.OMV_SERVER}users/${t}`)}updateUsers(t){return this.httpq.put(`${this.mongodb.OMV_SERVER}users/${t._id}`,t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(p.eN),e.LFG(b.r))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var h=o(7009),C=o(4726),v=o(7392),d=o(1561);const y=["editControlTrigger"];function x(s,a){if(1&s){const t=e.EpF();e.TgZ(0,"div")(1,"div",8)(2,"div",9),e._uU(3),e.qZA(),e.TgZ(4,"div",10),e._uU(5),e.qZA(),e.TgZ(6,"span",11)(7,"mat-icon",12),e.NdJ("click",function(){const i=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.editUser(i))}),e._uU(8,"edit"),e.qZA(),e.TgZ(9,"mat-icon",12),e.NdJ("click",function(){const i=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.onDelete(i))}),e._uU(10,"delete"),e.qZA()()()()}if(2&s){const t=a.$implicit;e.xp6(3),e.hij(" ",t.name," "),e.xp6(2),e.hij(" ",t.email," ")}}const T=[{path:"",component:(()=>{class s{constructor(t,r,n){this.dg=t,this.user=r,this.snkBar=n,this.usersList=[]}ngOnInit(){this.getList()}getList(){this.user.getUsersList().subscribe(t=>{this.usersList=t,this.orderList()})}orderList(){this.usersList.sort((t,r)=>t.name.localeCompare(r.name))}getClicked(t){switch(t.index){case 2:this.createUser();break;case 4:let r=document.getElementById("spanTrigger");r&&(r.style.display="",r.style.position="absolute",r.style.left=t.pageX+5+"px",r.style.top=t.pageY+5+"px",this.editControlTrigger.openMenu())}}createUser(){const t=this.user.newUser();this.dg.aDefault({title:"Crear Usuario",value:t,schema:{controls:[{name:"name",label:"Nombre:",type:"text",style:{width:"150px"},validators:{required:!0}},{name:"email",label:"Correo electr\xf3nico:",type:"text",style:{width:"150px"},validators:{required:!0}},{name:"password",label:"Contrase\xf1a:",type:"password",sideBtn:"visibility",validators:{required:!0}},{name:"rol",label:"Permisos:",type:"multiselect",validators:{},selectOptions:[{key:"0",value:"Editar Cotizaciones"},{key:"1",value:"Editar Listado de productos"},{key:"2",value:"Editar Usuarios"}]}]},dgheigth:465,dgwidth:300}).subscribe(i=>{if(i&&t){t.name=i.name,t.email=i.email,t.password=i.password,t.rol=i.rol||[];const l=this.user.createUsers(t).subscribe(u=>{l&&l.unsubscribe(),u&&(this.usersList.push(u),this.orderList())})}})}editUser(t){this.dg.aDefault({title:"Editar Roles de Usuario",value:t,schema:{controls:[{name:"rol",label:"Permisos:",type:"multiselect",validators:{},selectOptions:[{key:"0",value:"Editar Cotizaciones"},{key:"1",value:"Editar Productos"},{key:"2",value:"Editar Usuarios"}]}]},dgheigth:225,dgwidth:300}).subscribe(i=>{if(i){t.rol=i.rol||[];const l=this.user.updateUsers(t).subscribe(u=>{l&&l.unsubscribe(),u&&(this.usersList.push(u),this.orderList())})}})}onDelete(t){return this.snkBar.open(`\xbfEliminar usuario: ${t.name}?`,"Si",{duration:3e3}).onAction().subscribe(r=>{})}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(U.x),e.Y36(f),e.Y36(h.ux))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-users"]],viewQuery:function(t,r){if(1&t&&e.Gf(y,5),2&t){let n;e.iGM(n=e.CRH())&&(r.editControlTrigger=n.first)}},decls:10,vars:3,consts:[[1,"flex","flex-col","h-screen","bg-slate-100"],[3,"buttons","onClicked"],["id","spanTrigger",3,"matMenuTriggerFor"],["editControlTrigger","matMenuTrigger"],[1,"overflow-auto","bg-white"],[4,"ngFor","ngForOf"],["controlEdit","matMenu"],["mat-menu-item",""],[1,"h-10","px-2","flex","items-center","bg-gray-50","mt-1"],[1,"w-52","font-medium"],[1,"ml-3","flex-1","text-sky-700"],[1,"text-sky-300"],[3,"click"]],template:function(t,r){if(1&t&&(e.TgZ(0,"div",0)(1,"app-nav-bar",1),e.NdJ("onClicked",function(i){return r.getClicked(i)}),e.qZA(),e._UZ(2,"span",2,3),e.TgZ(4,"div",4),e.YNc(5,x,11,2,"div",5),e.qZA(),e.TgZ(6,"mat-menu",null,6)(8,"button",7),e._uU(9," Crear Usuario Maestro "),e.qZA()()()),2&t){const n=e.MAs(7);e.xp6(1),e.Q6J("buttons","101000"),e.xp6(1),e.Q6J("matMenuTriggerFor",n),e.xp6(3),e.Q6J("ngForOf",r.usersList)}},dependencies:[m.sg,C.w,v.Hw,d.VK,d.OP,d.p6]}),s})()}];let E=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[g.Bz.forChild(T),g.Bz]}),s})();var M=o(2469),L=o(4859);let w=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[m.ez,E,M.R,v.Ps,L.ot,h.ZX,d.Tx]}),s})()}}]);