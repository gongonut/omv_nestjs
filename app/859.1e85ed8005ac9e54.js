"use strict";(self.webpackChunkquote_cli_01=self.webpackChunkquote_cli_01||[]).push([[859],{6859:(Z,d,n)=>{n.r(d),n.d(d,{UsersModule:()=>M});var m=n(6895),p=n(2510),e=n(4650),v=n(2327),C=n(9340),g=n(7009),f=n(4726),h=n(7392),c=n(1561);const U=["editControlTrigger"];function b(s,l){if(1&s){const t=e.EpF();e.TgZ(0,"div")(1,"div",8)(2,"div",9),e._uU(3),e.qZA(),e.TgZ(4,"div",10),e._uU(5),e.qZA(),e.TgZ(6,"span",11)(7,"mat-icon",12),e.NdJ("click",function(){const r=e.CHM(t).$implicit,a=e.oxw();return e.KtG(a.editUser(r))}),e._uU(8,"edit"),e.qZA(),e.TgZ(9,"mat-icon",12),e.NdJ("click",function(){const r=e.CHM(t).$implicit,a=e.oxw();return e.KtG(a.onDelete(r))}),e._uU(10,"delete"),e.qZA()()()()}if(2&s){const t=l.$implicit;e.xp6(3),e.hij(" ",t.name," "),e.xp6(2),e.hij(" ",t.email," ")}}const y=[{path:"",component:(()=>{class s{constructor(t,i,o){this.dg=t,this.user=i,this.snkBar=o,this.usersList=[]}ngOnInit(){this.getList()}getList(){this.user.getUsersList().subscribe(t=>{this.usersList=t,this.orderList()})}orderList(){this.usersList.sort((t,i)=>t.name.localeCompare(i.name))}getClicked(t){switch(t.index){case 2:this.createUser();break;case 4:let i=document.getElementById("spanTrigger");i&&(i.style.display="",i.style.position="absolute",i.style.left=t.pageX+5+"px",i.style.top=t.pageY+5+"px",this.editControlTrigger.openMenu())}}createUser(){const t=this.user.newUser();this.dg.aDefault({title:"Crear Usuario",value:t,schema:{controls:[{name:"name",label:"Nombre:",type:"text",style:{width:"150px"},validators:{required:!0}},{name:"email",label:"Correo electr\xf3nico:",type:"text",style:{width:"150px"},validators:{required:!0}},{name:"password",label:"Contrase\xf1a:",type:"password",sideBtn:"visibility",validators:{required:!0}},{name:"rol",label:"Permiso para editar:",type:"multiselect",validators:{required:!0},selectOptions:[{key:"Q",value:"Cotizaciones"},{key:"P",value:"Productos"},{key:"C",value:"Condiciones Comerciales"},{key:"U",value:"Usuarios"}]}]},dgheigth:465,dgwidth:300}).subscribe(r=>{if(r&&t){t.name=r.name,t.email=r.email,t.password=r.password,t.rol=r.rol||[];const a=this.user.createUser(t).subscribe(u=>{a&&a.unsubscribe(),u&&(this.usersList.push(u),this.orderList())})}})}editUser(t){this.dg.aDefault({title:"Editar Roles de Usuario",value:t,schema:{controls:[{name:"rol",label:"Permiso para editar:",type:"multiselect",validators:{required:!0},selectOptions:[{key:"Q",value:"Cotizaciones"},{key:"P",value:"Productos"},{key:"C",value:"Condiciones Comerciales"},{key:"U",value:"Usuarios"}]}]},dgheigth:225,dgwidth:300}).subscribe(r=>{if(r){t.rol=r.rol||[];const a=this.user.updateUser(t).subscribe(u=>{a&&a.unsubscribe()})}})}onDelete(t){return this.snkBar.open(`\xbfEliminar usuario: ${t.name}?`,"Si",{duration:3e3}).onAction().subscribe(i=>{t._id&&this.user.deleteUser(t._id).subscribe(r=>{const a=this.usersList.findIndex(u=>u._id===t._id);a>=0&&this.usersList.splice(a,1)})})}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(v.x),e.Y36(C.z),e.Y36(g.ux))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-users"]],viewQuery:function(t,i){if(1&t&&e.Gf(U,5),2&t){let o;e.iGM(o=e.CRH())&&(i.editControlTrigger=o.first)}},decls:10,vars:3,consts:[[1,"flex","flex-col","h-screen","bg-slate-100"],[3,"buttons","onClicked"],["id","spanTrigger",3,"matMenuTriggerFor"],["editControlTrigger","matMenuTrigger"],[1,"overflow-auto","bg-white"],[4,"ngFor","ngForOf"],["controlEdit","matMenu"],["mat-menu-item",""],[1,"h-10","px-2","flex","items-center","bg-gray-50","mt-1"],[1,"w-52","font-medium"],[1,"ml-3","flex-1","text-sky-700"],[1,"text-sky-700"],[3,"click"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"app-nav-bar",1),e.NdJ("onClicked",function(r){return i.getClicked(r)}),e.qZA(),e._UZ(2,"span",2,3),e.TgZ(4,"div",4),e.YNc(5,b,11,2,"div",5),e.qZA(),e.TgZ(6,"mat-menu",null,6)(8,"button",7),e._uU(9," Crear Usuario Maestro "),e.qZA()()()),2&t){const o=e.MAs(7);e.xp6(1),e.Q6J("buttons","101000"),e.xp6(1),e.Q6J("matMenuTriggerFor",o),e.xp6(3),e.Q6J("ngForOf",i.usersList)}},dependencies:[m.sg,f.w,h.Hw,c.VK,c.OP,c.p6]}),s})()}];let x=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[p.Bz.forChild(y),p.Bz]}),s})();var T=n(2469),k=n(4859);let M=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[m.ez,x,T.R,h.Ps,k.ot,g.ZX,c.Tx]}),s})()}}]);